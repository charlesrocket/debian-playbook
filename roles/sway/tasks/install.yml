---

- name: ensure sway repo is present
  include_role:
    name: apt-repo-meta
  vars:
    apt_repo_keys:
      - "{{ sway_apt_key }}"
    apt_repo_repositories:
      - "{{ sway_apt_repo }}"

- name: ensure sway and its packages are installed
  include_role:
    name: apt-meta
  vars:
    apt_packages: "{{ [sway_package_name] + sway_shared_packages + sway_exclusive_packages }}"
    
- name: ensure config directory exists
  file:
    path: ~/.config/sway
    state: directory
    mode: 0755
    
- name: copy sway config file
  copy:
    src: /etc/sway/config
    dest: ~/.config/sway/config
    owner: "{{ ansible_user_id }}"
    group: "{{ ansible_user_id }}"
    mode: '0755'

- name: set wallpaper
  lineinfile:
    path: ~/.config/sway/config
    regexp: 'output * bg /usr/share/backgrounds/sway/Sway_Wallpaper_Blue_1920x1080.png fill'
    line: 'output * bg ~/pictures/hardcoding/zaki-aby-general-shot.jpg fill'
    state: present

- name: tune status bar 
  replace:
    path: ~/.config/sway/config
    regexp: '        background #323232'
    replace: '        background #000000AA'
    
- name: set gaps
  lineinfile:
    path: ~/.config/sway/config
    line: gaps inner 6
    
- name: set layout
  lineinfile:
    path: ~/.config/sway/config
    line: "{{ item }}"
  with_items:
    - "set $term terminator -b"
    - "default_border none"
    - "default_orientation auto"
    - "gaps inner 6"